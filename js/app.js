//todo: MARIUS - How do I put this stuff in a resource file?

var level1_answer1 = {
    response: 'Choux',
    elaboration: 'Choux pastry has a high moisture content which allows ' +
    'steam to force a tripling in size during baking. Its recipe is 2 parts water,' +
    ' 1 part butter, 1 part flour, 2 parts eggs, by weight.',
    imageURL: 'opt_pastryimages/choux_pastry.jpg',
    attribution: 'http://www.kidspot.co.nz/recipes-for+2464+20+Cakes-&-Baking+Choux-pastry-recipe.htm',
    learningLink: 'http://www.deliaonline.com/how-to-cook/baking/how-to-make-choux-pastry.html'
};

var level1_answer2 = {
    response: 'Puff',
    elaboration: 'Puff pastry has 1:0.9 ratio of flour to butter, by weight.',
    imageURL: 'opt_pastryimages/puff_pastry.jpg',
    attribution: 'http://www.jusrolprofessional.co.uk/pastry-techniques/rolling-puff-pastry.aspx',
    learningLink: 'http://bigbaketheory.com/2012/01/08/pate-feuilletee-puff-pastry/'
};

var level1_answer3 = {
    response: 'Shortcrust',
    elaboration: 'Shortcrust pastry has 2:1 ratio of flour to ' +
    'fat, by weight.',
    imageURL: 'opt_pastryimages/shortcrust.jpg',
    attribution: 'http://www.bbcgoodfood.com/recipes/2983/basic-shortcrust-pastry',
    learningLink: 'https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=9&cad=rja&uact=8&ved=0CGkQtwIwCGoVChMIl6jd0cqXyQIVxkkmCh1SSQ_P&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D1siW_wm9TnA&usg=AFQjCNGsesZKrrvwlp7XbOlJD7vZdYJMuQ&sig2=JiTUkl3sWV-f9x6925LRyg'
};

var level1_answer4 = {
    response: 'Arlettes',
    elaboration: 'Arlettes are narrow slices of puff pastry flavored with cinnamon' +
    ' and arranged in spirals.',
    imageURL: 'opt_pastryimages/arlettes.jpg',
    attribution: 'http://www.bbc.co.uk/food/recipes/arlettes_17164',
    learningLink: 'http://www.bbc.co.uk/food/recipes/arlettes_17164'
};

var level1_answer5 = {
    response: 'Vols-au-vents',
    elaboration: 'Vols-au-vents use a small, hollow, case of puff pastry, made by' +
    ' cutting two circles in rolled out puff, cutting a hole in one of them, then' +
    ' stacking the ring-shaped piece on top of the disk-shaped piece.  Can be ' +
    'savory or sweet-filled.',
    imageURL: 'opt_pastryimages/vols-au-vent.jpg',
    attribution: 'http://www.lifesambrosia.com/2009/09/vols-au-vent-recipe.html',
    learningLink: 'http://www.lifesambrosia.com/2009/09/vols-au-vent-recipe.html'
};

var level1_answer6 = {
    response: 'Baklava',
    elaboration: 'Sometimes confused with puff pastry, phyllo/filo ' +
    'dough also has many layers, but unlike puff, has no fat content' +
    ' (so you brush it with butter!)',
    imageURL: 'opt_pastryimages/baklava.jpg',
    attribution: 'http://www.recipe.com/apricot-and-pistachio-baklava-with-orange-cardamom-syrup/',
    learningLink: 'http://www.recipe.com/apricot-and-pistachio-baklava-with-orange-cardamom-syrup/'
};

var level2_answer1 = {
    response: 'Opera cake',
    elaboration: 'A thin almond sponge, sandwiched with ganache and' +
    ' coffee syrup, and topped with a dark chocolate glaze.',
    imageURL: 'opt_pastryimages/opera_cake.jpg',
    attribution: 'http://danieruben.blogspot.com/2010/05/opera-cake.html',
    learningLink: 'http://danieruben.blogspot.com/2010/05/opera-cake.html'
};

var level2_answer2 = {
    response: 'Couronne',
    elaboration: 'From the French word for crown, a wreath of sweet ' +
    'bread laced with a filling via rolling, slicing open, and twisting.',
    imageURL: 'opt_pastryimages/couronne.jpg',
    attribution: 'http://www.bbc.co.uk/food/recipes/apricot_couronne_12975',
    learningLink: 'http://www.bbc.co.uk/food/recipes/apricot_couronne_12975'
};

var level2_answer3 = {
    response: 'Dacquoise',
    elaboration: 'A dessert made with hazelnut meringue layers and ' +
    'whipped cream or buttercream',
    imageURL: 'opt_pastryimages/dacquoise.jpg',
    attribution: 'https://claphamkitchen.wordpress.com/2013/10/15/hazelnut-dacquoise/',
    learningLink: 'https://claphamkitchen.wordpress.com/2013/10/15/hazelnut-dacquoise/'
};

var level2_answer4 = {
    response: 'Kransekake',
    elaboration: 'This Swedish showstopper uses a set of graduated' +
    ' molds to build a tower of iced rings resembling a Christmas tree.',
    imageURL: 'opt_pastryimages/kransekake.jpg',
    attribution: 'http://www.examiner.co.uk/lifestyle/food-drink/recipe-kransekake-stephen-jackson-4966937',
    learningLink: 'http://scandinavianfood.about.com/od/introduction/ig/Kransekake-photo-gallery/'
};

var level2_answer5 = {
    response: 'Genoa Cake',
    elaboration: 'A variant of the Pandolce cake popular in Italy, which' +
    ' shares several identifying attributes with the homemade American Christmas' +
    ' fruitcake.',
    imageURL: 'opt_pastryimages/genoa_cake.jpg',
    attribution: 'http://indaily.com.au/food-and-wine/recipes/2013/09/03/genoa-cake-a-true-show-stopper/',
    learningLink: 'http://indaily.com.au/food-and-wine/recipes/2013/09/03/genoa-cake-a-true-show-stopper/'
};

var level2_answer6 = {
    response: 'Povitica',
    elaboration: 'An Eastern European sweet bread traditionally ' +
    'served at Christmas, featuring narrow layers of filling ' +
    '(chocolate, walnut, and poppyseed are common)' +
    'filling rolled and then crammed into a loaf tin, producing complex ' +
    'marbling in the slices.',
    imageURL: 'opt_pastryimages/povitica.jpg',
    attribution: 'http://alpineberry.blogspot.com/2011/10/povitica.html',
    learningLink: 'http://alpineberry.blogspot.com/2011/10/povitica.html'
};

var level3_answer1 = {
    response: 'Schichttorte',
    elaboration: 'This German 20-layer cake is cooked under the' +
    ' broiler/grill, rather than the oven.',
    imageURL: 'opt_pastryimages/schichttorte.jpg',
    attribution: 'http://emmaforth.blogspot.com/2014/10/technical-thursday-pauls-schichttorte.html',
    learningLink: 'http://emmaforth.blogspot.com/2014/10/technical-thursday-pauls-schichttorte.html'
};

var level3_answer2 = {
    response: 'Mokatines',
    elaboration: 'Genoise sponge cut in cubes, layered with coffee' +
    ' buttercream, edged with chopped nuts stuck on with apricot jam, decorated' +
    ' with coffee-flavored buttercream, and glazed with fontant icing.',
    imageURL: 'opt_pastryimages/mokatines.jpg',
    attribution: 'http://gloverlycupcakes.com/2015/09/30/gbbo-technical-challenge-no-8-mokatines/',
    learningLink: 'http://thegreatbritishbakeoff.co.uk/marys-mokatines-technical-challenge/'
};

var level3_answer3 = {
    response: 'Entremets',
    elaboration: 'A multi-layered mousse-filled cake using joconde' +
    ' sponge comprising of different complementary flavors with varying textural' +
    ' contrasts',
    imageURL: 'opt_pastryimages/entremets.jpg',
    attribution: 'https://granddiplomelondon.wordpress.com/2012/07/24/day-119-and-120-create-my-own-entremet-mon-23rd-and-tues-24th-july/',
    learningLink: 'https://stickofachef.wordpress.com/2008/07/28/the-anatomy-of-an-entremet-%E2%80%93-part-1/'
};

var level3_answer4 = {
    response: 'Flaounes',
    elaboration: 'A Cypriot pecorino/halloumi cheese-filled pastry' +
    ' flavored with ground mahlepi',
    imageURL: 'opt_pastryimages/flaounes.jpg',
    attribution: 'http://www.sbs.com.au/food/recipes/cypriot-easter-bread-flaounes',
    learningLink: 'http://www.sbs.com.au/food/recipes/cypriot-easter-bread-flaounes'
};

var level3_answer5 = {
    response: 'Religieuses',
    elaboration: 'Two choux buns filled with pastry cream, topped' +
    ' with chocolate ganache and decorated with a whipped cream \'collar\'.',
    imageURL: 'opt_pastryimages/religieuse.jpg',
    attribution: 'http://www.bbc.co.uk/food/recipes/religieuse_46431',
    learningLink: 'https://www.meilleurduchef.com/cgi/mdc/l/en/recipe/coffee-religieuses.html'
};

var level3_answer6 = {
    response: 'Kouign Amann',
    elaboration: 'A Breton cake rather like puff pastry or croissantskoui, but ' +
    'with sugar included in the fewer layers.',
    imageURL: 'opt_pastryimages/kouign_amann.jpg',
    attribution: 'http://www.karenskitchenstories.com/2015/03/kouign-amann.html',
    learningLink: 'http://www.karenskitchenstories.com/2015/03/kouign-amann.html'
};
var scoreState = {
    UNSCORED: 1,
    CORRECT: 2,
    INCORRECT: 3
};

var level1_question1 = {
    prompt: 'Which pastry has the highest fat content?',
    correctAnswer: level1_answer2,
    possibleAnswers: [level1_answer1, level1_answer2, level1_answer3],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/fat2.jpg',
    attribution: 'http://food52.com/blog/3414-a-shortcut-to-perfect-puff-pastry'
};

var level1_question2 = {
    prompt: 'Which biscuits (cookies) are NOT made from puff pastry?',
    correctAnswer: level1_answer3,
    possibleAnswers: [level1_answer4, level1_answer5, level1_answer6],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/puff_closeup.jpg',
    attribution: 'http://food52.com/blog/3414-a-shortcut-to-perfect-puff-pastry'
};

var level2_question1 = {
    prompt: 'Which cake would work for a gluten-free friend\'s birthday?',
    correctAnswer: level2_answer3,
    possibleAnswers: [level2_answer1, level2_answer2, level2_answer3],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/gluten_free.jpg',
    attribution: 'http://www.nakedavocado.com/gluten/'
};

var level2_question2 = {
    prompt: 'Which holiday treat requires a special set of molds?',
    correctAnswer: level2_answer1,
    possibleAnswers: [level2_answer4, level2_answer5, level2_answer6],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/baking-trays.jpg',
    attribution: 'http://www.kitchensourcebook.co.uk/2009/12/29/vintage-baking-trays/'
};

var level3_question1 = {
    prompt: 'Which difficult bake has 20 layers?',
    correctAnswer: level3_answer1,
    possibleAnswers: [level3_answer1, level3_answer2, level3_answer3],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/chocolate_layers.jpg',
    attribution: 'http://www.delish.com/cooking/g767/chocolate-cakes/'
};

var level3_question2 = {
    prompt: 'Which of these French-sounding pastries isn\'t actually French?',
    correctAnswer: level3_answer1,
    possibleAnswers: [level3_answer4, level3_answer5, level3_answer6],
    score: scoreState.UNSCORED,
    imageURL: 'opt_pastryimages/eiffel_tower.jpg',
    attribution: 'http://www.clipartbest.com/clipart-eaTeLj5i4'
};

var holdharmless = 'This app has been prepared as an educational programming exercise and no' +
    ' profit is generated from its use.  Images appearing within are included in' +
    ' appreciation for the baker\'s skills, and attribution is given for their' +
    ' sources.  Images are planned to be replaced by alternates owned by the student when' +
    ' she successfully makes all of them.' +
    '  All rights reserved.';

var explanationHeader = 'Love cooking shows, but no time to bake?  How big' +
    ' a fan are you?';
var instructions = 'Choose a question and test your baking knowledge.  Choose a' +
    ' higher level and raise the heat in the kitchen. Learn more (and support ' +
    'the bakers!) by following the links.';

var level1Questions = {keyLabel: 'level1', questions: [level1_question1, level1_question2]};
var level2Questions = {keyLabel: 'level2', questions: [level2_question1, level2_question2]};
var level3Questions = {keyLabel: 'level3', questions: [level3_question1, level3_question2]};
var allTheLevels = [level1Questions, level2Questions, level3Questions];

var currentLevel = 1;
var currentQuestions = [];
var userScore = 0;

//DEFINE HELPER FUNCTIONS FIRST...

function hideIntro(){
    $('#focus h2').hide();
    $('#focus h3').hide();
    $('#focus h6').hide();
}

function loadQuestions(level){
    var levelName = 'level' + level;

    for (var i=0; i<allTheLevels.length; i++){
        var questionBatchKey = allTheLevels[i].keyLabel;

        if (questionBatchKey == levelName){
            currentQuestions = allTheLevels[i].questions;

            for (var j=0; j<currentQuestions.length; j++){
                $('#questions').append('<li>' + '<i class="fa fa-question fa-2x icons" alt="Try this question">' + '</i>' + '</li>');
            }
        }
    }
}

function showAnswer(){
    alert($(this).index() + ' answer clicked');
    var choiceNumber = $(this).index();
    $('#choices li').removeClass('active');
    $(this).addClass('active');
    //todo: change li.color = active state
    //todo: set #focus h1.text() = question.scoredState
    //todo: set #focus h2.text() = answer.elaboration
    //todo: set learnMore link
    updateScore();
}

function showIntro(){
    $('#photo-attribution').hide();
    $('#learn-more').hide();
    var quizTitle = "Which Bake?";
    $('#focus h1').show();
    $('#focus h2').show();
    $('#focus h3').show();
    $('#focus h6').show();
    $('#focus').css('background-image','none');
    $('#focus h1').html(quizTitle);
    $('#focus h2').html(explanationHeader);
    $('#focus h3').html(instructions);
    $('#focus h6').html(holdharmless);
    $('#questions li').remove();
    $('#choices li').remove();
}

function showItem(){
    var indexNumber = $(this).index();
    $('#questions li').removeClass('active');
    $(this).addClass('active');
    hideIntro();
    showItemContent(indexNumber);
}

function showItemContent(indexNumber){
    var chosenQuestion;
    for (var i=0; i<currentQuestions.length; i++){
        if (indexNumber == i){
            chosenQuestion = currentQuestions[i];
            var ask = chosenQuestion.prompt;
            var askImageURL = 'url(' + chosenQuestion.imageURL + ')';
            var imgSource = chosenQuestion.attribution;
            var choices = chosenQuestion.possibleAnswers;
            $('#focus h1').html(ask);
            $('#focus').css('background-image', askImageURL);
            $('#photo-attribution').show();
            $('#photo-attribution').attr('href', imgSource);
            $('#photo-attribution').attr('alt',imgSource);
            $('#focus h2').hide();
            $('#learn-more').hide();
            showItemOptions(choices);
        }
    }
}

function showItemOptions(possibleAnswers){
    //clear out what's there
    $('#choices li').remove();

    //set #choices li from possibleAnswers
    for (var i=0; i<possibleAnswers.length; i++){
        var urlString = 'url(' + possibleAnswers[i].imageURL + ')';
        var choiceTitle = possibleAnswers[i].response;
        $('#choices').append('<li width="132px" height="90px">' +
            '<div class="frosted">' + choiceTitle + '</div>' + '</li>');
        $('#choices li:last-child').css('background-image', urlString);
        $('#choices li:last-child').attr('alt',urlString);
    }
}

function resetScore(){
    userScore = 0;
}

function updateScore(){
    // todo: MARIUS - charting recommendation?
    // todo: how many questions are loaded?
    // todo: how many are correct?
    // todo: update UI...?
}

//<li><i class="fa fa-check-square-o fa-2x icons" alt="You rock! Click to reread"></i></li>
//<li><i class="fa fa-times fa-2x icons" alt="Missed this one. Click to try again"></i></li>

//SECOND, TARGETS AVAILABLE ON PAGE LOAD:

$( document ).ready(function() {
    event.preventDefault(); //prevents default reloading
    showIntro();
    resetScore();
    loadQuestions(1);
    $('#theme-picker li:first-child').addClass('theme-highlight');

    $( '#addItem').click(function() {
        //SHOW ENTRY
        $('.entry-box').show();
    });

    $('#theme-picker li').click(function() {
    //write li's index to chosen Level (default = 1)
        currentLevel = $(this).index() + 1;

        $('#questions li').remove();
        loadQuestions(currentLevel);
        //showFirstQuestion(currentLevel); //todo

        //change highlight of li's to indicate level
        $('#theme-picker li').removeClass('theme-highlight');
        $(this).addClass('theme-highlight');
    });

//on #restart click,
    $('#restart').click(function() {
        showIntro();
        resetScore();
        loadQuestions(1);
    });
});

//THIRD, TARGETS NOT AVAILABLE ON PAGE LOAD

//on #questions li.click, show associated quiz question
$(document).on('click', '#questions li', showItem);

//on #choices li.click, show enlarged answer image and text
$(document).on('click', '#choices li', showAnswer);




